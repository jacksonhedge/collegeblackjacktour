var G=Object.defineProperty;var B=(i,t,a)=>t in i?G(i,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[t]=a;var S=(i,t,a)=>B(i,typeof t!="symbol"?t+"":t,a);import{a as F,r as l,j as e,aD as z}from"./main-Bt21LLck.js";import{b as C,N as M,S as R,a as W}from"./networkGraph-BxK0k-6n.js";import"./transform-CnDyqK0n.js";const L="https://fantasy.espn.com/apis/v3/games/ffl";class f{static setCookies(t,a){this.cookies=`espn_s2=${t}; SWID=${a}`}static async getLeague(t,a="2024"){try{return(await C.get(`${L}/seasons/${a}/segments/0/leagues/${t}`,{headers:{Cookie:this.cookies},params:{view:["mTeam","mRoster","mSettings","mStandings"]}})).data}catch(r){throw console.error("Error fetching ESPN league:",r),r}}static async getLeagueMembers(t,a="2024"){try{return(await C.get(`${L}/seasons/${a}/segments/0/leagues/${t}`,{headers:{Cookie:this.cookies},params:{view:"mTeam"}})).data.teams||[]}catch(r){throw console.error("Error fetching ESPN league members:",r),r}}static async importLeague(t,a="2024"){try{const r=await this.getLeague(t,a),o=(r.teams||[]).map((p,m)=>{var x;const c=((x=p.owners)==null?void 0:x[0])||{};return{id:`espn_${c.id||`team_${m}`}`,name:p.name||`Team ${m+1}`,platforms:{espn:{userId:c.id||`team_${m}`,teamName:p.name}}}});return{id:`espn_${t}`,name:r.settings.name,platform:"espn",platformLeagueId:t,season:a,members:o,createdAt:new Date,sport:"nfl",settings:{scoringType:r.settings.scoringType,teamCount:r.settings.size,playoffTeams:r.settings.playoffTeamCount}}}catch(r){throw console.error("Error importing ESPN league:",r),r}}static async getUserLeagues(t){return console.warn("ESPN API does not provide direct access to user leagues. Users must provide league IDs."),[]}}S(f,"cookies","");const K=()=>{const{isAdminAuthenticated:i}=F(),[t,a]=l.useState([]),[r,N]=l.useState(null),[o,p]=l.useState(null),[m,c]=l.useState(!1),[x,U]=l.useState(null),[h,y]=l.useState(""),[b,w]=l.useState(""),[d,v]=l.useState({espnS2:"",swid:""});if(!i)return e.jsx(z,{to:"/admin",replace:!0});l.useEffect(()=>{t.length>0&&k()},[t]);const k=()=>{const g=new M(t).buildGraph();N(g),E(g,t)},E=(s,g)=>{const $=s.nodes.filter(n=>n.platforms.includes("sleeper")).length,A=s.nodes.filter(n=>n.platforms.includes("espn")).length,T=s.nodes.filter(n=>n.platforms.length>1).length,j=s.nodes.map(n=>({user:{id:n.id,name:n.name},connections:s.links.filter(u=>u.source===n.id||u.target===n.id).length})),D=j.reduce((n,u)=>n+u.connections,0)/s.nodes.length,_=j.sort((n,u)=>u.connections-n.connections).slice(0,5);p({totalUsers:s.nodes.length,totalLeagues:g.length,sleeperUsers:$,espnUsers:A,crossPlatformUsers:T,avgConnectionsPerUser:D,mostConnectedUsers:_})},P=async()=>{if(h){c(!0);try{const s=await R.importUserLeagues(h);a([...t,...s]),y("")}catch(s){console.error("Failed to import Sleeper leagues:",s)}finally{c(!1)}}},I=async()=>{if(!(!b||!d.espnS2||!d.swid)){c(!0);try{f.setCookies(d.espnS2,d.swid);const s=await f.importLeague(b);a([...t,s]),w("")}catch(s){console.error("Failed to import ESPN league:",s)}finally{c(!1)}}};return e.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-8",children:"Fantasy Network Admin Dashboard"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Import Leagues"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Sleeper Import"}),e.jsx("input",{type:"text",placeholder:"Sleeper username",value:h,onChange:s=>y(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-4"}),e.jsx("button",{onClick:P,disabled:m,className:"w-full bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 disabled:bg-gray-400",children:"Import Sleeper Leagues"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"ESPN Import"}),e.jsx("input",{type:"text",placeholder:"ESPN League ID",value:b,onChange:s=>w(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"}),e.jsx("input",{type:"text",placeholder:"espn_s2 cookie",value:d.espnS2,onChange:s=>v({...d,espnS2:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-2"}),e.jsx("input",{type:"text",placeholder:"SWID cookie",value:d.swid,onChange:s=>v({...d,swid:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg mb-4"}),e.jsx("button",{onClick:I,disabled:m,className:"w-full bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 disabled:bg-gray-400",children:"Import ESPN League"})]})]})]}),o&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Network Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:o.totalUsers}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Users"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:o.totalLeagues}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Leagues"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:o.sleeperUsers}),e.jsx("div",{className:"text-sm text-gray-600",children:"Sleeper Users"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:o.espnUsers}),e.jsx("div",{className:"text-sm text-gray-600",children:"ESPN Users"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:o.crossPlatformUsers}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cross-Platform"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-600",children:o.avgConnectionsPerUser.toFixed(1)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Avg Connections"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Most Connected Users"}),e.jsx("div",{className:"space-y-2",children:o.mostConnectedUsers.map((s,g)=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 last:border-0",children:[e.jsx("span",{className:"font-medium",children:s.user.name}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.connections," connections"]})]},g))})]})]}),r&&e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-6",children:"Network Visualization"}),e.jsx(W,{graph:r,onNodeClick:s=>U(s.id),width:typeof window<"u"?Math.min(window.innerWidth-100,1200):1200,height:600})]})]})})};export{K as default};
