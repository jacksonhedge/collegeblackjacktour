import{a7 as se,q as N,e as j,f as y,o as E,aK as L,aL as ae,g as w,aM as D,P as A,i as B,h as R,r as g,j as e,aI as $,X as re,D as V,R as ne,I as ie,v as Q,N as le,C as ce}from"./main-Bt21LLck.js";import{A as z}from"./activity-rhRbEMqz.js";import{C as k}from"./circle-check-big-PbtGHC_l.js";import{C}from"./circle-x-Ch5ljYmC.js";import{C as oe}from"./credit-card-ubWgKOyE.js";import{A as de}from"./arrow-down-right-DEPCSBqA.js";import{A as xe}from"./arrow-up-right-DQDCwTvG.js";import{T as me}from"./triangle-alert-BHLbSyoS.js";import{M as he}from"./mail-Dke56W7c.js";import{D as pe}from"./download-CwePtl3-.js";import{E as ge}from"./ellipsis-vertical-CNMPpEyx.js";/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=se("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);class ue{constructor(){this.usersCollection="users",this.transactionsCollection="transactions",this.depositsCollection="deposits",this.withdrawalsCollection="withdrawals"}async getUsersPaginated(r=50,t=null){try{let i=N(j(y,this.usersCollection),E("createdAt","desc"),L(r));t&&(i=N(j(y,this.usersCollection),E("createdAt","desc"),ae(t),L(r)));const l=await w(i),a=[];for(const c of l.docs){const x=c.data(),d=await this.enrichUserData(c.id,x);a.push(d)}return{users:a,lastDoc:l.docs[l.docs.length-1],hasMore:l.docs.length===r}}catch(i){throw console.error("Error fetching users:",i),i}}async enrichUserData(r,t){var i,l,a,c,x,d,m;try{const h=await this.getUserTransactionSummary(r),u=await this.getUserFinancialSummary(r),o=this.calculateAccountAge(t.createdAt),f=await this.getUserLastActivity(r);return{id:r,...t,username:t.username||"N/A",email:t.email||"N/A",phoneNumber:t.phoneNumber||"N/A",createdAt:t.createdAt||D.now(),lastSeen:t.lastSeen||t.createdAt,lastActivity:f,accountAge:o,balance:{cash:((i=t.balance)==null?void 0:i.cash)||0,bonus:((l=t.balance)==null?void 0:l.bonus)||0,total:(((a=t.balance)==null?void 0:a.cash)||0)+(((c=t.balance)==null?void 0:c.bonus)||0)},transactions:h,financials:u,status:this.getUserStatus(t),riskLevel:this.calculateRiskLevel(t,h,u),referralCode:t.referralCode||"N/A",referredBy:t.referredBy||null,referralCount:((x=t.referrals)==null?void 0:x.length)||0,leagues:((d=t.leagues)==null?void 0:d.length)||0,friends:((m=t.friends)==null?void 0:m.length)||0,emailVerified:t.emailVerified||!1,phoneVerified:t.phoneVerified||!1,kycStatus:t.kycStatus||"pending",notifications:{email:t.emailSubscribed||!1,push:t.pushNotifications||!1,sms:t.smsNotifications||!1}}}catch(h){return console.error("Error enriching user data:",h),{id:r,...t,error:"Failed to load complete data"}}}async getUserTransactionSummary(r){try{const t=N(j(y,this.transactionsCollection),A("userId","==",r)),l=(await w(t)).docs.map(c=>({id:c.id,...c.data()})),a={total:l.length,volume:0,sent:{count:0,amount:0},received:{count:0,amount:0},deposits:{count:0,amount:0},withdrawals:{count:0,amount:0},lastTransaction:null};if(l.forEach(c=>{const x=c.amount||0;a.volume+=Math.abs(x),c.type==="deposit"?(a.deposits.count++,a.deposits.amount+=x):c.type==="withdrawal"?(a.withdrawals.count++,a.withdrawals.amount+=Math.abs(x)):c.type==="send"||c.fromUserId===r?(a.sent.count++,a.sent.amount+=Math.abs(x)):(c.type==="receive"||c.toUserId===r)&&(a.received.count++,a.received.amount+=x)}),l.length>0){const c=l.sort((x,d)=>{var m,h;return(((m=d.createdAt)==null?void 0:m.toMillis())||0)-(((h=x.createdAt)==null?void 0:h.toMillis())||0)});a.lastTransaction=c[0]}return a}catch(t){return console.error("Error getting transaction summary:",t),{total:0,volume:0,sent:{count:0,amount:0},received:{count:0,amount:0},deposits:{count:0,amount:0},withdrawals:{count:0,amount:0},lastTransaction:null}}}async getUserFinancialSummary(r){try{const t=N(j(y,this.depositsCollection),A("userId","==",r)),i=await w(t);let l=0,a=null,c=null;i.forEach(u=>{const o=u.data();l+=o.amount||0,(!a||o.createdAt&&o.createdAt<a.createdAt)&&(a=o),(!c||o.createdAt&&o.createdAt>c.createdAt)&&(c=o)});const x=N(j(y,this.withdrawalsCollection),A("userId","==",r)),d=await w(x);let m=0,h=null;return d.forEach(u=>{const o=u.data();m+=o.amount||0,(!h||o.createdAt&&o.createdAt>h.createdAt)&&(h=o)}),{deposits:{total:l,count:i.size,first:a,last:c},withdrawals:{total:m,count:d.size,last:h},netDeposits:l-m,lifetime:l}}catch(t){return console.error("Error getting financial summary:",t),{deposits:{total:0,count:0,first:null,last:null},withdrawals:{total:0,count:0,last:null},netDeposits:0,lifetime:0}}}async getUserLastActivity(r){try{const t=[],i=N(j(y,this.transactionsCollection),A("userId","==",r),E("createdAt","desc"),L(1)),l=await w(i);if(!l.empty){const a=l.docs[0].data();t.push({type:"transaction",timestamp:a.createdAt,description:`${a.type} - $${a.amount}`})}return t.length>0?(t.sort((a,c)=>c.timestamp-a.timestamp),t[0]):null}catch(t){return console.error("Error getting last activity:",t),null}}calculateAccountAge(r){if(!r)return"Unknown";const t=r.toDate?r.toDate():new Date(r),l=new Date-t,a=Math.floor(l/(1e3*60*60*24));return a<1?"Today":a===1?"1 day":a<30?`${a} days`:a<365?`${Math.floor(a/30)} months`:`${Math.floor(a/365)} years`}getUserStatus(r){var l;if(!r.emailVerified)return"unverified";if(r.suspended)return"suspended";if(r.inactive)return"inactive";const t=(l=r.lastSeen)!=null&&l.toDate?r.lastSeen.toDate():new Date(r.lastSeen),i=Math.floor((new Date-t)/(1e3*60*60*24));return i>30?"dormant":i>7?"inactive":"active"}calculateRiskLevel(r,t,i){let l=0;r.emailVerified||(l+=2),r.phoneVerified||(l+=2),r.kycStatus!=="approved"&&(l+=3),t.volume/(t.total||1)>1e3&&(l+=2),t.withdrawals.amount>i.deposits.total*.9&&(l+=3);const c=this.calculateAccountAge(r.createdAt);return(c.includes("day")||c==="Today")&&(l+=2),l>=7?"high":l>=4?"medium":"low"}async searchUsers(r){try{const t=[],i=N(j(y,this.usersCollection),A("email","==",r));(await w(i)).forEach(d=>{t.push({id:d.id,...d.data()})});const a=N(j(y,this.usersCollection),A("username","==",r));(await w(a)).forEach(d=>{t.find(m=>m.id===d.id)||t.push({id:d.id,...d.data()})});const x=[];for(const d of t){const m=await this.enrichUserData(d.id,d);x.push(m)}return x}catch(t){throw console.error("Error searching users:",t),t}}async updateUserStatus(r,t){try{const i=B(y,this.usersCollection,r);return await R(i,{status:t,statusUpdatedAt:D.now(),statusUpdatedBy:"admin"}),!0}catch(i){throw console.error("Error updating user status:",i),i}}async suspendUser(r,t){try{const i=B(y,this.usersCollection,r);return await R(i,{suspended:!0,suspendedAt:D.now(),suspendedReason:t,suspendedBy:"admin"}),!0}catch(i){throw console.error("Error suspending user:",i),i}}async reactivateUser(r){try{const t=B(y,this.usersCollection,r);return await R(t,{suspended:!1,reactivatedAt:D.now(),reactivatedBy:"admin"}),!0}catch(t){throw console.error("Error reactivating user:",t),t}}async getUserStatistics(){try{const r=await w(j(y,this.usersCollection)),t={total:r.size,active:0,inactive:0,suspended:0,verified:0,unverified:0,totalDeposits:0,totalWithdrawals:0,averageBalance:0,newToday:0,newThisWeek:0,newThisMonth:0},i=new Date,l=new Date(i.getFullYear(),i.getMonth(),i.getDate()),a=new Date(l.getTime()-7*24*60*60*1e3),c=new Date(l.getTime()-30*24*60*60*1e3);let x=0;return r.forEach(d=>{var o,f,T;const m=d.data(),h=this.getUserStatus(m);h==="active"?t.active++:h==="suspended"?t.suspended++:t.inactive++,m.emailVerified?t.verified++:t.unverified++,x+=(((o=m.balance)==null?void 0:o.cash)||0)+(((f=m.balance)==null?void 0:f.bonus)||0);const u=(T=m.createdAt)!=null&&T.toDate?m.createdAt.toDate():new Date(m.createdAt);u>=l&&t.newToday++,u>=a&&t.newThisWeek++,u>=c&&t.newThisMonth++}),t.averageBalance=t.total>0?x/t.total:0,t}catch(r){throw console.error("Error getting user statistics:",r),r}}}const U=new ue,ye=({user:s,onClose:r,onAction:t})=>{const[i,l]=g.useState("overview");if(!s)return null;const a=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o||0),c=o=>o?(o.toDate?o.toDate():new Date(o)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",x=o=>o?e.jsx(k,{className:"w-4 h-4 text-green-500"}):e.jsx(C,{className:"w-4 h-4 text-red-500"}),d=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Basic Information"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"User ID"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Username"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.username})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.email}),x(s.emailVerified)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Phone"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.phoneNumber}),x(s.phoneVerified)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"KYC Status"}),e.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded ${s.kycStatus==="approved"?"bg-green-100 text-green-800":s.kycStatus==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:s.kycStatus})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Account Details"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Created"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c(s.createdAt)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Last Seen"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c(s.lastSeen)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Account Age"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.accountAge})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status"}),e.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded ${s.status==="active"?"bg-green-100 text-green-800":s.status==="suspended"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Risk Level"}),e.jsx("span",{className:`text-sm font-medium px-2 py-1 rounded ${s.riskLevel==="low"?"bg-green-100 text-green-800":s.riskLevel==="medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.riskLevel})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Social & Referrals"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Referral Code"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.referralCode})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Referred By"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.referredBy||"Direct Sign-up"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Referrals Made"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.referralCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Friends"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.friends})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Leagues"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.leagues})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Notification Preferences"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email Notifications"}),s.notifications.email?e.jsx(k,{className:"w-4 h-4 text-green-500"}):e.jsx(C,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Push Notifications"}),s.notifications.push?e.jsx(k,{className:"w-4 h-4 text-green-500"}):e.jsx(C,{className:"w-4 h-4 text-gray-400"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"SMS Notifications"}),s.notifications.sms?e.jsx(k,{className:"w-4 h-4 text-green-500"}):e.jsx(C,{className:"w-4 h-4 text-gray-400"})]})]})]})]}),m=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Current Balance"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx(V,{className:"w-5 h-5 text-green-600 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:a(s.balance.cash)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cash Balance"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx(oe,{className:"w-5 h-5 text-blue-600 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a(s.balance.bonus)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Bonus Balance"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx(V,{className:"w-5 h-5 text-purple-600 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:a(s.balance.total)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Balance"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Transaction Summary"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Transactions"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.transactions.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Transaction Volume"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(s.transactions.volume)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Money Sent"}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:[a(s.transactions.sent.amount)," (",s.transactions.sent.count," txns)"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Money Received"}),e.jsxs("span",{className:"text-sm font-medium text-green-600",children:[a(s.transactions.received.amount)," (",s.transactions.received.count," txns)"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Deposits & Withdrawals"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(de,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Deposits"})]}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:a(s.financials.deposits.total)}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.financials.deposits.count," deposits"]}),s.financials.deposits.last&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Last: ",c(s.financials.deposits.last.createdAt)]})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(xe,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Withdrawals"})]}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:a(s.financials.withdrawals.total)}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[s.financials.withdrawals.count," withdrawals"]}),s.financials.withdrawals.last&&e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Last: ",c(s.financials.withdrawals.last.createdAt)]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Financial Metrics"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Net Deposits"}),e.jsx("span",{className:`text-sm font-medium ${s.financials.netDeposits>=0?"text-green-600":"text-red-600"}`,children:a(s.financials.netDeposits)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Lifetime Value"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(s.financials.lifetime)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Average Transaction"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:a(s.transactions.total>0?s.transactions.volume/s.transactions.total:0)})]})]})]})]}),h=()=>e.jsxs("div",{className:"space-y-6",children:[s.lastActivity&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Last Activity"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.lastActivity.description}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c(s.lastActivity.timestamp)})]}),e.jsx(z,{className:"w-5 h-5 text-blue-600"})]})})]}),s.transactions.lastTransaction&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Last Transaction"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.transactions.lastTransaction.type}),e.jsx("span",{className:`text-sm font-medium ${s.transactions.lastTransaction.type==="deposit"||s.transactions.lastTransaction.type==="receive"?"text-green-600":"text-red-600"}`,children:a(s.transactions.lastTransaction.amount)})]}),e.jsx("p",{className:"text-xs text-gray-500",children:c(s.transactions.lastTransaction.createdAt)})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Activity Timeline"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-600 text-center py-8",children:"Detailed activity timeline coming soon..."})})]})]}),u=[{id:"overview",label:"Overview",icon:$},{id:"financials",label:"Financials",icon:V},{id:"activity",label:"Activity",icon:z}];return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx($,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s.username}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(re,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex",children:u.map(o=>{const f=o.icon;return e.jsxs("button",{onClick:()=>l(o.id),className:`flex items-center gap-2 px-6 py-3 text-sm font-medium border-b-2 transition-colors ${i===o.id?"text-purple-600 border-purple-600":"text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(f,{className:"w-4 h-4"}),o.label]},o.id)})})}),e.jsxs("div",{className:"p-6 overflow-y-auto",style:{maxHeight:"calc(90vh - 200px)"},children:[i==="overview"&&d(),i==="financials"&&m(),i==="activity"&&h()]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[s.status==="suspended"?e.jsxs("button",{onClick:()=>t(s.id,"reactivate"),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),"Reactivate User"]}):e.jsxs("button",{onClick:()=>t(s.id,"suspend"),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Suspend User"]}),e.jsxs("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"Send Email"]})]}),e.jsx("button",{onClick:r,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})]})})},Me=()=>{const[s,r]=g.useState([]),[t,i]=g.useState(!0),[l,a]=g.useState(null),[c,x]=g.useState(""),[d,m]=g.useState("all"),[h,u]=g.useState("createdAt"),[o,f]=g.useState(null),[T,F]=g.useState(!1),[v,H]=g.useState(null),[K,O]=g.useState(null),[I,W]=g.useState(!1),[X,P]=g.useState(1);g.useEffect(()=>{b(),Y()},[]);const b=async(n=!1)=>{try{i(!0),a(null);const p=await U.getUsersPaginated(50,n?K:null);r(n?S=>[...S,...p.users]:p.users),O(p.lastDoc),W(p.hasMore)}catch(p){console.error("Error loading users:",p),a("Failed to load users")}finally{i(!1)}},Y=async()=>{try{const n=await U.getUserStatistics();H(n)}catch(n){console.error("Error loading statistics:",n)}},G=async()=>{if(!c.trim()){b();return}try{i(!0);const n=await U.searchUsers(c);r(n),W(!1)}catch(n){console.error("Error searching users:",n),a("Search failed")}finally{i(!1)}},J=async(n,p)=>{try{switch(p){case"suspend":await U.suspendUser(n,"Suspended by admin");break;case"reactivate":await U.reactivateUser(n);break}b()}catch(S){console.error(`Error performing ${p}:`,S),alert(`Failed to ${p} user`)}},Z=n=>{const p={active:{color:"bg-green-100 text-green-800",icon:k},inactive:{color:"bg-gray-100 text-gray-800",icon:C},dormant:{color:"bg-yellow-100 text-yellow-800",icon:Q},suspended:{color:"bg-red-100 text-red-800",icon:C},unverified:{color:"bg-orange-100 text-orange-800",icon:Q}},S=p[n]||p.inactive,te=S.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.color}`,children:[e.jsx(te,{className:"w-3 h-3 mr-1"}),n]})},_=n=>{const p={low:"bg-green-100 text-green-800",medium:"bg-yellow-100 text-yellow-800",high:"bg-red-100 text-red-800"};return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded ${p[n]||p.low}`,children:n})},M=n=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n||0),ee=n=>n?(n.toDate?n.toDate():new Date(n)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"N/A",q=s.filter(n=>d==="all"?!0:n.status===d);return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"User Management"}),e.jsx("button",{onClick:()=>b(),className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",children:e.jsx(ne,{className:"w-5 h-5"})})]}),v&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.total})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:v.active})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Verified"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:v.verified})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"New Today"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:v.newToday})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:v.newThisWeek})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Avg Balance"}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:M(v.averageBalance)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by email or username...",value:c,onChange:n=>x(n.target.value),onKeyPress:n=>n.key==="Enter"&&G(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),e.jsxs("select",{value:d,onChange:n=>m(n.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"dormant",children:"Dormant"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"unverified",children:"Unverified"})]}),e.jsxs("button",{className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Info"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Balance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Activity"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Risk"}),e.jsx("th",{className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t&&s.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-gray-500",children:"Loading users..."})}):q.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-6 py-4 text-center text-gray-500",children:"No users found"})}):q.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx($,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:n.username}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",n.id.slice(0,8),"..."]})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:n.email}),e.jsx("div",{className:"text-sm text-gray-500",children:n.phoneNumber})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:ee(n.createdAt)}),e.jsx("div",{className:"text-sm text-gray-500",children:n.accountAge})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:M(n.balance.total)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Cash: ",M(n.balance.cash)]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[n.transactions.total," txns"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[M(n.transactions.volume)," vol"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z(n.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:_(n.riskLevel)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>{f(n),F(!0)},className:"text-purple-600 hover:text-purple-900 mr-3",children:"View"}),e.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:e.jsx(ge,{className:"w-4 h-4"})})]})]},n.id))})]})}),I&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>{P(n=>n-1),b()},disabled:X===1,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:e.jsx(le,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm text-gray-700",children:["Showing ",s.length," users"]}),e.jsx("button",{onClick:()=>{P(n=>n+1),b(!0)},disabled:!I,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:e.jsx(ce,{className:"w-4 h-4"})})]}),T&&o&&e.jsx(ye,{user:o,onClose:()=>{F(!1),f(null)},onAction:J})]})};export{Te as U,Me as a};
