import{u as me,y as pe,d as ue,r as l,j as e,A as xe,U as he,T as ye,C as D,z as N,F as fe,I as be,X as je}from"./main-CIF9t6XU.js";import{g as Y}from"./GroupService-DlhNiBgH.js";import{I as _}from"./input-DZxtkRTY.js";import{I as Ne}from"./InviteUsersModalEnhanced-D16Bx1SZ.js";import{L as W}from"./loader-circle-bHa5NdPL.js";import{U as ve}from"./user-plus-DI_TvP4x.js";import"./alert-DSPc-G07.js";import"./button-ooYe08FM.js";import"./EmailService-CRBjdB80.js";import"./key-BfkyW3y6.js";import"./copy-Dba7HXDr.js";import"./mail-BthhqBKa.js";import"./message-square-Dsl2VSSP.js";import"./share-2-D0Q1OSBU.js";const Re=()=>{const y=me(),{currentUser:v}=pe(),{isDark:s}=ue(),[n,d]=l.useState("type"),[f,z]=l.useState(""),[c,O]=l.useState(""),[w,F]=l.useState(""),[E,q]=l.useState("👥"),[x,X]=l.useState(""),[S,H]=l.useState(null),[G,J]=l.useState([]),[r,K]=l.useState(null),[m,Q]=l.useState([]),[V,I]=l.useState(!1),[b,T]=l.useState(""),[$,C]=l.useState([]),[p,M]=l.useState([]),[k,R]=l.useState(!1),[L,u]=l.useState(""),[Z,U]=l.useState(!1),[h,ee]=l.useState(null),te=[{id:"friends",title:"Group of Friends",description:"Create a casual group to share bankrolls and compete",icon:he,color:"from-blue-500 to-purple-600"},{id:"fantasy",title:"Fantasy League",description:"Connect your fantasy league for automated tracking",icon:ye,color:"from-purple-500 to-pink-600"}],se=[{id:"sleeper",name:"Sleeper Fantasy League",logo:"/images/sleeperFantasy.png",color:"#F7B500",description:"Import your Sleeper league"},{id:"espn",name:"ESPN Fantasy League",logo:"/images/espnFantasy.png",color:"#D50A0A",description:"Connect your ESPN league"},{id:"yahoo",name:"Yahoo Fantasy League",logo:"/images/yahoofantasy.png",color:"#7B0099",description:"Link your Yahoo league"},{id:"nfl",name:"NFL App Fantasy League",logo:"/images/nfl-logo.png",color:"#013369",description:"Connect your NFL league"},{id:"cbs",name:"CBS Fantasy League",logo:"/images/cbs.png",color:"#0066CC",description:"Add your CBS league"},{id:"other",name:"Other Fantasy League",logo:null,color:"#666666",description:"Manual fantasy league setup"}];l.useEffect(()=>{const t=setTimeout(async()=>{if(b.length>=2)try{const g=(await Y.searchUsers(b)).filter(o=>o.uid!==v.uid&&!p.some(i=>i.uid===o.uid));C(g)}catch(a){console.error("Error searching users:",a)}else C([])},300);return()=>clearTimeout(t)},[b,v.uid,p]);const ae=async()=>{I(!0),u("");try{const t=await N.getUser(x);if(!t){u("Sleeper username not found");return}H(t);const a=new Date().getFullYear(),o=(await N.getUserLeagues(t.user_id,a,"nfl")).filter(i=>i.status==="in_season"||i.status==="complete");J(o),o.length===0&&u("No active leagues found for this user")}catch(t){console.error("Error fetching Sleeper leagues:",t),u("Failed to fetch Sleeper leagues")}finally{I(!1)}},re=async t=>{try{const a=await N.getLeagueUsers(t);Q(a)}catch(a){console.error("Error fetching league members:",a)}},j=async()=>{n==="type"?d(f==="fantasy"?"platform":"details"):n==="platform"?d("details"):n==="details"?c==="sleeper"&&x?(await ae(),d("league-select")):d("members"):n==="league-select"&&r&&(await re(r.league_id),d("members"))},A=()=>{n==="platform"?d("type"):n==="details"?d(f==="fantasy"?"platform":"type"):n==="league-select"?d("details"):n==="members"&&d(c==="sleeper"&&r?"league-select":"details")},B=async()=>{R(!0),u("");try{let t=[...p];if(c==="sleeper"&&r&&m.length>0){const o=m.filter(i=>i.user_id!==(S==null?void 0:S.user_id)).map(i=>{var P;return{identifier:i.user_id,type:"sleeper",status:"pending",sleeperData:{user_id:i.user_id,username:i.username||i.display_name,display_name:i.display_name,avatar:i.avatar,team_name:(P=i.metadata)==null?void 0:P.team_name}}});t=[...t,...o]}const a={name:w||(r==null?void 0:r.name)||"Untitled Group",type:f,platform:c||"bankroll",emoji:E||(c==="sleeper"?"🏈":"👥"),sleeperUsername:c==="sleeper"?x:null,leagueInfo:c==="sleeper"&&r?{leagueId:r.league_id,leagueName:r.name,sport:r.sport||"nfl",season:r.season,platform:"sleeper",totalRosters:r.total_rosters,status:r.status,settings:r.settings}:null,pendingMembers:t.map(o=>o.type==="sleeper"?o:{uid:o.uid,displayName:o.displayName,username:o.username,email:o.email,phone:o.phone,photoURL:o.photoURL})},g=await Y.createGroup(a,v);ee(g),t.length>0||c==="sleeper"&&m.length>0?U(!0):y(`/groups/${g.id}`)}catch(t){console.error("Error creating group:",t),u("Failed to create group")}finally{R(!1)}},le=t=>{M(a=>[...a,t]),C(a=>a.filter(g=>g.uid!==t.uid)),T("")},oe=t=>{M(a=>a.filter(g=>g.uid!==t.uid))},ne=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${s?"text-white":"text-gray-900"}`,children:"What type of group?"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Choose how you want to organize your group"})]}),e.jsx("div",{className:"grid gap-4",children:te.map(t=>{const a=t.icon;return e.jsxs("button",{onClick:()=>{z(t.id),j()},className:`relative overflow-hidden rounded-xl p-6 text-left transition-all hover:scale-[1.02] ${s?"bg-gray-800 hover:bg-gray-700":"bg-white hover:bg-gray-50"} border ${s?"border-gray-700":"border-gray-200"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${t.color} opacity-10`}),e.jsxs("div",{className:"relative flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-lg bg-gradient-to-r ${t.color}`,children:e.jsx(a,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-lg font-semibold mb-1 ${s?"text-white":"text-gray-900"}`,children:t.title}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:t.description})]}),e.jsx(D,{className:`w-5 h-5 ${s?"text-gray-400":"text-gray-500"}`})]})]},t.id)})})]}),ie=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${s?"text-white":"text-gray-900"}`,children:"Select your platform"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Which fantasy platform is your league on?"})]}),e.jsx("div",{className:"grid gap-3",children:se.map(t=>e.jsxs("button",{onClick:()=>{O(t.id),j()},className:`flex items-center gap-4 p-4 rounded-lg transition-all hover:scale-[1.01] ${s?"bg-gray-800 hover:bg-gray-700":"bg-white hover:bg-gray-50"} border ${s?"border-gray-700":"border-gray-200"}`,children:[t.logo?e.jsx("img",{src:t.logo,alt:t.name,className:"w-12 h-12 object-contain",onError:a=>{a.currentTarget.src="/images/BankrollLogoTransparent.png"}}):e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-white font-bold text-lg",style:{backgroundColor:t.color},children:t.name[0]}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h3",{className:`font-semibold ${s?"text-white":"text-gray-900"}`,children:t.name}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:t.description})]}),e.jsx(D,{className:`w-5 h-5 ${s?"text-gray-400":"text-gray-500"}`})]},t.id))})]}),ce=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${s?"text-white":"text-gray-900"}`,children:"Select your league"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Choose which Sleeper league to import"})]}),V?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(W,{className:"w-8 h-8 animate-spin text-purple-600"})}):G.length>0?e.jsx("div",{className:"space-y-3",children:G.map(t=>{var a;return e.jsx("button",{onClick:()=>{K(t),F(t.name)},className:`w-full p-4 rounded-lg border transition-all ${(r==null?void 0:r.league_id)===t.league_id?"border-purple-600 bg-purple-600/10":s?"border-gray-700 bg-gray-800 hover:bg-gray-700":"border-gray-200 bg-white hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:`font-semibold ${s?"text-white":"text-gray-900"}`,children:t.name}),e.jsxs("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:[t.total_rosters," teams • ",(a=t.sport)==null?void 0:a.toUpperCase()," • ",t.season]})]}),(r==null?void 0:r.league_id)===t.league_id&&e.jsx("div",{className:"bg-purple-600 rounded-full p-1",children:e.jsx(fe,{className:"w-4 h-4 text-white"})})]})},t.league_id)})}):e.jsx("div",{className:`text-center py-8 rounded-lg border ${s?"border-gray-700 bg-gray-800":"border-gray-200 bg-gray-100"}`,children:e.jsx("p",{className:`${s?"text-gray-400":"text-gray-600"}`,children:L||"No leagues found for this user"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:A,className:`flex-1 py-3 rounded-lg font-medium transition-colors ${s?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Back"}),e.jsx("button",{onClick:j,disabled:!r,className:"flex-1 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"Continue"})]})]}),de=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${s?"text-white":"text-gray-900"}`,children:"Group details"}),e.jsx("p",{className:"text-sm text-gray-300",children:c==="sleeper"?"Enter your Sleeper username":"Set up your group"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Group Name"}),e.jsx(_,{type:"text",value:w,onChange:t=>F(t.target.value),placeholder:"Enter group name",className:s?"bg-gray-800 border-gray-700":"",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Group Icon"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-8 gap-2",children:["👥","🏈","🏀","⚾","⚽","🏒","🎯","💰","🎲","🃏","🎰","🏆","💎","🚀","🔥","⭐"].map(t=>e.jsx("button",{type:"button",onClick:()=>q(t),className:`p-2 text-2xl rounded-lg transition-all ${E===t?"bg-purple-600 ring-2 ring-purple-500 ring-offset-2"+(s?" ring-offset-gray-900":" ring-offset-white"):s?"bg-gray-800 hover:bg-gray-700":"bg-gray-100 hover:bg-gray-200"}`,children:t},t))}),e.jsx("div",{className:`p-3 rounded-lg border-2 border-dashed ${s?"border-gray-700":"border-gray-300"}`,children:e.jsx("p",{className:"text-xs text-center text-gray-500",children:"Custom image upload coming soon"})})]})]}),c==="sleeper"&&e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Sleeper Username"}),e.jsx(_,{type:"text",value:x,onChange:t=>X(t.target.value),placeholder:"Enter your Sleeper username",className:s?"bg-gray-800 border-gray-700":""}),e.jsx("p",{className:`mt-2 text-xs ${s?"text-gray-400":"text-gray-600"}`,children:"We'll import your leagues and rosters automatically"})]}),e.jsx("button",{onClick:j,disabled:!w.trim()||c==="sleeper"&&!x.trim(),className:"w-full py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:"Continue"})]})]}),ge=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${s?"text-white":"text-gray-900"}`,children:c==="sleeper"&&m.length>0?"League Members":"Invite members"}),e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:c==="sleeper"&&m.length>0?`${m.length} members will be invited from your Sleeper league`:"Add friends to your group (optional)"})]}),c==="sleeper"&&m.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:`text-sm font-medium mb-3 ${s?"text-gray-300":"text-gray-700"}`,children:"Sleeper League Members"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:m.map(t=>{var a;return e.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg ${s?"bg-gray-800":"bg-gray-100"}`,children:[t.avatar?e.jsx("img",{src:N.getAvatarUrl(t.avatar),alt:t.display_name||t.username,className:"w-8 h-8 rounded-full"}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center text-white text-sm font-bold",children:(t.display_name||t.username||"?")[0].toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-sm font-medium truncate ${s?"text-white":"text-gray-900"}`,children:t.display_name||t.username}),((a=t.metadata)==null?void 0:a.team_name)&&e.jsx("div",{className:`text-xs truncate ${s?"text-gray-400":"text-gray-600"}`,children:t.metadata.team_name})]})]},t.user_id)})}),e.jsx("p",{className:"mt-3 text-xs text-gray-300",children:"These members will receive invites to join your Bankroll group. They'll need to create or connect their Bankroll account."}),e.jsx("div",{className:"mt-3 p-3 bg-purple-600/10 border border-purple-600/20 rounded-lg",children:e.jsx("p",{className:"text-xs text-purple-300",children:"After creating the group, you'll be able to invite them via text message or email."})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(_,{type:"text",value:b,onChange:t=>T(t.target.value),placeholder:"Search by username, email, or phone",className:`pl-10 ${s?"bg-gray-800 border-gray-700":""}`})]}),$.length>0&&e.jsx("div",{className:`border rounded-lg overflow-hidden ${s?"border-gray-700 bg-gray-800":"border-gray-200 bg-white"}`,children:$.map((t,a)=>e.jsxs("button",{onClick:()=>le(t),className:`w-full p-3 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-700 ${a!==$.length-1?"border-b dark:border-gray-700":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL&&e.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:t.displayName}),e.jsx("div",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:t.username||t.email||t.phone})]})]}),e.jsx(ve,{className:"w-5 h-5 text-purple-600"})]},`search-${t.uid}-${a}`))}),p.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:`text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:["Selected Members (",p.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.map((t,a)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${s?"bg-gray-800":"bg-gray-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.photoURL&&e.jsx("img",{src:t.photoURL,alt:t.displayName,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("div",{className:`font-medium text-sm ${s?"text-white":"text-gray-900"}`,children:t.displayName}),e.jsx("div",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:t.username||t.email||t.phone})]})]}),e.jsx("button",{onClick:()=>oe(t),className:"p-1 hover:bg-gray-200 dark:hover:bg-gray-700 rounded",children:e.jsx(je,{className:"w-4 h-4 text-gray-500"})})]},`selected-${t.uid}-${a}`))})]}),e.jsx("button",{onClick:B,disabled:k,className:"w-full py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium flex items-center justify-center gap-2",children:k?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"w-4 h-4 animate-spin"}),"Creating Group..."]}):"Create Group"}),e.jsx("button",{onClick:B,disabled:k,className:`w-full py-3 rounded-lg transition-colors font-medium ${s?"text-gray-400 hover:text-gray-300":"text-gray-600 hover:text-gray-700"}`,children:"Skip and Create Group"})]})]});return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>n==="type"?y("/groups"):A(),className:`flex items-center gap-2 text-sm ${s?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[e.jsx(xe,{className:"w-4 h-4"}),"Back"]}),e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const t=f==="friends"?["type","details","members"]:c==="sleeper"?["type","platform","details","league-select","members"]:["type","platform","details","members"];return t.map((a,g)=>{const o=a===n,i=t.indexOf(n)>g;return e.jsx("div",{className:`w-2 h-2 rounded-full transition-all ${o?"w-8 bg-purple-600":i?"bg-purple-600":s?"bg-gray-700":"bg-gray-300"}`},a)})})()})]}),L&&e.jsx("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-500 text-sm",children:L}),n==="type"&&ne(),n==="platform"&&ie(),n==="details"&&de(),n==="league-select"&&ce(),n==="members"&&ge(),Z&&h&&e.jsx(Ne,{groupId:h.id,groupName:h.name,onClose:()=>{U(!1),y(`/groups/${h.id}`)},onInvite:()=>{U(!1),y(`/groups/${h.id}`)}})]})};export{Re as default};
