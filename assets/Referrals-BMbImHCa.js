import{y as v,d as R,r as i,aE as d,j as e,Q as l,V as n,U as D,D as E,G as I,a1 as x,a2 as m,F as L,K as o,c as T,u as P,A}from"./main-CIF9t6XU.js";import{B as N}from"./button-ooYe08FM.js";import{I as w}from"./input-DZxtkRTY.js";import{C as B}from"./copy-Dba7HXDr.js";const G=()=>{const{currentUser:a}=v(),{isDark:s}=R(),[t,S]=i.useState(null),[c,g]=i.useState(""),[h,p]=i.useState(!1),[C,j]=i.useState(!1),[f,$]=i.useState(""),[u,k]=i.useState([]);i.useEffect(()=>{a!=null&&a.id&&b()},[a]);const b=async()=>{const[r,_]=await Promise.all([d.getReferralStats(a.id),d.getReferralRewards(a.id)]);S(r),k(_.slice(0,3)),r!=null&&r.referral_code&&$(d.generateReferralLink(r.referral_code))},F=()=>{navigator.clipboard.writeText(f),j(!0),o.success("Referral link copied!"),setTimeout(()=>j(!1),3e3)},y=async()=>{if(!c||!c.includes("@")){o.error("Please enter a valid email");return}p(!0),await d.sendReferralInvite(a.id,c)?(o.success("Invite sent successfully!"),g(""),b()):o.error("Failed to send invite. Please try again."),p(!1)};return t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(l,{className:`${s?"bg-gradient-to-br from-purple-900 to-purple-700 border-purple-600":"bg-gradient-to-br from-purple-500 to-purple-600 border-purple-400"} text-white`,children:e.jsxs(n,{className:"p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(D,{className:"h-5 w-5"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80 mb-1",children:"Total Referrals"}),e.jsx("p",{className:"text-2xl font-bold",children:t.referral_count}),e.jsxs("p",{className:"text-xs mt-1 opacity-70",children:[t.pending_invites," pending invites"]})]})]})}),e.jsx(l,{className:`${s?"bg-gradient-to-br from-green-900 to-green-700 border-green-600":"bg-gradient-to-br from-green-500 to-green-600 border-green-400"} text-white`,children:e.jsxs(n,{className:"p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(E,{className:"h-5 w-5"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80 mb-1",children:"Total Earned"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",t.referral_earnings.toFixed(2)]}),e.jsx("p",{className:"text-xs mt-1 opacity-70",children:"From referral rewards"})]})]})}),e.jsx(l,{className:`${s?"bg-gradient-to-br from-indigo-900 to-purple-700 border-indigo-600":"bg-gradient-to-br from-indigo-500 to-purple-600 border-indigo-400"} text-white`,children:e.jsxs(n,{className:"p-5",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(I,{className:"h-5 w-5"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm opacity-80 mb-1",children:"Your Rewards"}),e.jsx("p",{className:"text-lg font-bold",children:"$10 per signup"}),e.jsx("p",{className:"text-xs mt-1 opacity-70",children:"+ bonuses on deposits"})]})]})})]}),e.jsxs(l,{className:s?"bg-gray-800 border-gray-700":"bg-white border-purple-200",children:[e.jsx(x,{children:e.jsx(m,{className:s?"text-white":"text-gray-900",children:"Your Referral Link"})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{value:f,readOnly:!0,className:`flex-1 ${s?"bg-gray-900 border-gray-700":"bg-gray-50"}`}),e.jsx(N,{onClick:F,variant:"outline",className:"min-w-[100px]",children:C?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"w-4 h-4 mr-2"}),"Copied!"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Copy"]})})]}),e.jsx("div",{className:`p-3 rounded-lg ${s?"bg-gray-900":"bg-purple-50"}`,children:e.jsxs("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:["Share your referral code: ",e.jsx("span",{className:"font-mono font-bold",children:t.referral_code})]})})]})})]}),e.jsxs(l,{className:s?"bg-gray-800 border-gray-700":"bg-white border-purple-200",children:[e.jsx(x,{children:e.jsx(m,{className:s?"text-white":"text-gray-900",children:"Invite Friends"})}),e.jsx(n,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{type:"email",placeholder:"Enter friend's email",value:c,onChange:r=>g(r.target.value),onKeyPress:r=>r.key==="Enter"&&y(),className:s?"bg-gray-900 border-gray-700":"bg-gray-50"}),e.jsx(N,{onClick:y,disabled:h||!c,className:"min-w-[120px]",children:h?"Sending...":e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Send Invite"]})})]})})]}),u.length>0&&e.jsxs(l,{className:s?"bg-gray-800 border-gray-700":"bg-white border-purple-200",children:[e.jsx(x,{children:e.jsx(m,{className:s?"text-white":"text-gray-900",children:"Recent Rewards"})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-3",children:u.map(r=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${s?"bg-gray-900/50":"bg-gray-50"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:r.reward_type==="signup"?"New Signup":r.reward_type==="deposit"?"Friend Deposited":"Activity Bonus"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(r.created_at).toLocaleDateString()})]}),e.jsxs("p",{className:"font-semibold text-green-500",children:["+$",r.reward_amount.toFixed(2)]})]},r.id))})})]})]}):e.jsx("div",{children:"Loading..."})},O=()=>{const{currentUser:a}=v(),{isDark:s}=R(),t=P();return e.jsxs("div",{className:"min-h-screen p-4 md:p-6 transition-colors duration-200",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>t("/wallet"),className:`flex items-center gap-2 mb-4 ${s?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"} transition-colors`,children:[e.jsx(A,{className:"w-4 h-4"}),"Back to Wallet"]}),e.jsx("h1",{className:`text-2xl md:text-3xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Referral Program"}),e.jsx("p",{className:`text-sm mt-1 ${s?"text-gray-400":"text-gray-600"}`,children:"Invite friends and earn rewards together"})]}),e.jsx(G,{})]})};export{O as default};
