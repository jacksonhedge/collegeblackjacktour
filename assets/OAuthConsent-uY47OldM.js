import{a7 as q,aG as L,u as R,r as a,s as B,j as e,a0 as V,X as D,S as y,F,B as G,U as w,aH as S,aI as A}from"./main-CIF9t6XU.js";import{M as W}from"./mail-BthhqBKa.js";import{G as $}from"./globe-DJMS5fni.js";/**
 * @license lucide-react v0.363.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=q("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);class b{constructor(){this.instance=null}static getInstance(){return this.instance||(this.instance=new b),this.instance}async validateAuthorizationRequest(l){throw new Error("OAuth operations must be performed on the server")}async exchangeCodeForToken(l,j,c,h){throw new Error("OAuth operations must be performed on the server")}async validateAccessToken(l){throw new Error("OAuth operations must be performed on the server")}async revokeAccessToken(l){throw new Error("OAuth operations must be performed on the server")}}const d=b.getInstance();function Y(){const[n]=L(),l=R(),[j,c]=a.useState(!0),[h,k]=a.useState(!1),[t,C]=a.useState(null),[u,U]=a.useState(null),[v,x]=a.useState(null),[f,I]=a.useState([]),i=n.get("client_id"),g=n.get("redirect_uri"),N=n.get("scope"),m=n.get("state"),E=n.get("code_challenge"),z=n.get("code_challenge_method"),P={openid:$,profile:A,email:W,"wallets:read":S,"wallets:write":S,"groups:read":w,"groups:write":w,"friends:read":w,"notifications:write":G,offline_access:H},M={openid:"Access your unique identifier",profile:"View your profile information (name, avatar)",email:"View your email address","wallets:read":"View your wallet balances and transaction history","wallets:write":"Perform wallet operations like deposits and withdrawals","groups:read":"View your groups and group information","groups:write":"Create and manage groups on your behalf","friends:read":"View your friends list","notifications:write":"Send you notifications",offline_access:"Access your data when you are offline"};a.useEffect(()=>{O()},[]);const O=async()=>{try{const{data:{user:r}}=await B.auth.getUser();if(!r){const p=new URL(window.location.href);l(`/login?return_to=${encodeURIComponent(p)}`);return}if(U(r),!i||!g||!N){x("Invalid request: Missing required parameters"),c(!1);return}const s=await d.getClient(i);if(!s){x("Invalid client"),c(!1);return}C(s);const o=N.split(" ").filter(p=>p);if(I(o),await d.hasUserConsented(r.id,i,o)||s.is_verified){await _(!0);return}c(!1)}catch(r){console.error("Error in OAuth consent:",r),x("An error occurred while processing your request"),c(!1)}},_=async(r=!1)=>{k(!0);try{r||await d.saveUserConsent(u.id,i,f);const s=await d.createAuthorizationCode(i,u.id,g,f,E,z);await d.updateClientStatistics(i,"authorization");const o=new URL(g);o.searchParams.append("code",s),m&&o.searchParams.append("state",m),window.location.href=o.toString()}catch(s){console.error("Error approving consent:",s),x("Failed to authorize application"),k(!1)}},T=()=>{const r=new URL(g);r.searchParams.append("error","access_denied"),m&&r.searchParams.append("state",m),window.location.href=r.toString()};return j?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:e.jsx(V,{})}):v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4",children:e.jsx("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900",children:e.jsx(D,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsx("h2",{className:"mt-4 text-xl font-semibold text-gray-900 dark:text-white",children:"Authorization Error"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:v})]})})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 px-4 py-8",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:"/images/BankrollLogoTransparent.png",alt:"Bankroll",className:"h-12 mx-auto mb-2"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Sign in with Bankroll"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[t.logo_url?e.jsx("img",{src:t.logo_url,alt:t.name,className:"h-16 w-16 rounded-lg object-cover flex-shrink-0"}):e.jsx("div",{className:"h-16 w-16 rounded-lg bg-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t.description||"This application would like to:"}),t.is_verified&&e.jsxs("div",{className:"mt-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),"Verified by Bankroll"]})]})]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-4",children:"This app will be able to:"}),e.jsx("ul",{className:"space-y-3",children:f.map(r=>{const s=P[r]||y;return e.jsxs("li",{className:"flex items-start",children:[e.jsx(s,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:M[r]||r})]},r)})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[e.jsx("strong",{children:t.name})," will not be able to:"]}),e.jsxs("ul",{className:"mt-2 space-y-1 text-xs text-blue-700 dark:text-blue-300",children:[e.jsx("li",{children:"• Access your password or PIN"}),e.jsx("li",{children:"• Make transactions without your approval"}),e.jsx("li",{children:"• Access data beyond what's listed above"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center text-sm text-gray-600 dark:text-gray-400",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Signing in as ",u.email]})]})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-900 flex justify-between space-x-3",children:[e.jsx("button",{onClick:T,disabled:h,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:()=>_(!1),disabled:h,className:"flex-1 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:h?"Authorizing...":"Authorize"})]}),e.jsx("div",{className:"px-6 py-3 bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-center space-x-4 text-xs",children:[t.privacy_policy_url&&e.jsx("a",{href:t.privacy_policy_url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Privacy Policy"}),t.terms_of_service_url&&e.jsx("a",{href:t.terms_of_service_url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Terms of Service"}),t.support_email&&e.jsx("a",{href:`mailto:${t.support_email}`,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:"Support"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(y,{className:"inline h-3 w-3 mr-1"}),"This authorization is secure and follows OAuth 2.0 standards"]})})]})})}export{Y as default};
